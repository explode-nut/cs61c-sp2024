<!DOCTYPE html>
<!-- saved from url=(0088)https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Part B _ CS 61C Spring 2024_files/analytics.js.下载" type="text/javascript"></script>
<script type="text/javascript">window.addEventListener('DOMContentLoaded',function(){var v=archive_analytics.values;v.service='wb';v.server_name='wwwb-app215.us.archive.org';v.server_ms=495;archive_analytics.send_pageview({});});</script>
<script type="text/javascript" src="./Part B _ CS 61C Spring 2024_files/bundle-playback.js.下载" charset="utf-8"></script>
<script type="text/javascript" src="./Part B _ CS 61C Spring 2024_files/wombat.js.下载" charset="utf-8"></script>
<script>window.RufflePlayer=window.RufflePlayer||{};window.RufflePlayer.config={"autoplay":"on","unmuteOverlay":"hidden"};</script>
<script type="text/javascript" src="./Part B _ CS 61C Spring 2024_files/ruffle.js.下载"></script>
<script type="text/javascript">
    __wm.pc(0.001);
    __wm.init("https://web.archive.org/web");
  __wm.wombat("https://cs61c.org/sp24/projects/proj2/part-b/","20240310023422","https://web.archive.org/","web","https://web-static.archive.org/_static/",
	      "1710038062");
</script>
<link rel="stylesheet" type="text/css" href="./Part B _ CS 61C Spring 2024_files/banner-styles.css">
<link rel="stylesheet" type="text/css" href="./Part B _ CS 61C Spring 2024_files/iconochive.css">
<!-- End Wayback Rewrite JS Include -->


<meta name="language" content="english">
<title>Part B | CS 61C Spring 2024</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">
<link rel="shortcut icon" type="image/png" href="https://web.archive.org/web/20240310023422im_/https://cs61c.org/sp24/img/favicon.png">
<link rel="stylesheet" href="./Part B _ CS 61C Spring 2024_files/bootstrap.min.css" integrity="" crossorigin="anonymous" referrerpolicy="no-referrer">
<script defer="" src="./Part B _ CS 61C Spring 2024_files/bootstrap.min.js.下载" integrity="" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script defer="" src="./Part B _ CS 61C Spring 2024_files/instantpage.min.js.下载" integrity="" crossorigin="anonymous"></script>
<link rel="stylesheet" href="./Part B _ CS 61C Spring 2024_files/main.css">
<script defer="" type="text/javascript" src="./Part B _ CS 61C Spring 2024_files/main.js.下载"></script>

<script type="text/javascript" src="./Part B _ CS 61C Spring 2024_files/main-sync.js.下载"></script>
<script>initDarkToggle();</script>
<script defer="" src="./Part B _ CS 61C Spring 2024_files/tocbot.min.js.下载" integrity="" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</head>
<body><!-- BEGIN WAYBACK TOOLBAR INSERT -->
<script>__wm.rw(0);</script>
<div id="wm-ipp-base" lang="en" style="display: block; direction: ltr;"><template shadowrootmode="closed"><div id="wm-ipp" style="position:fixed;left:0;top:0;right:0;">
<div id="donato" style="position:relative;width:100%;">
  <div id="donato-base">
    <iframe id="donato-if" src="https://archive.org/includes/donate.php?as_page=1&amp;platform=wb&amp;referer=https%3A//web.archive.org/web/20240310023422/https%3A//cs61c.org/sp24/projects/proj2/part-b/" scrolling="no" frameborder="0" style="width:100%; height:100%">
    </iframe>
  </div>
</div><div id="wm-ipp-inside">
  <div id="wm-toolbar" style="position:relative;display:flex;flex-flow:row nowrap;justify-content:space-between;">
    <div id="wm-logo" style="/*width:110px;*/padding-top:12px;">
      <a href="https://web.archive.org/web/" title="Wayback Machine home page"><img src="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png" srcset="https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-100.png, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-150.png 1.5x, https://web-static.archive.org/_static/images/toolbar/wayback-toolbar-logo-200.png 2x" alt="Wayback Machine" style="width:100px" border="0"></a>
    </div>
    <div class="c" style="display:flex;flex-flow:column nowrap;justify-content:space-between;flex:1;">
      <form class="u" style="display:flex;flex-direction:row;flex-wrap:nowrap;" target="_top" method="get" action="https://web.archive.org/web/submit" name="wmtb" id="wmtb"><input type="text" name="url" id="wmtbURL" value="https://cs61c.org/sp24/projects/proj2/part-b/" onfocus="this.focus();this.select();" style="flex:1;" autocomplete="off"><input type="hidden" name="type" value="replay"><input type="hidden" name="date" value="20240310023422"><input type="submit" value="Go">
      </form>
      <div style="display:flex;flex-flow:row nowrap;align-items:flex-end;">
                <div class="s" id="wm-nav-captures" style="flex:1;"><a class="t" href="https://web.archive.org/web/*/https://cs61c.org/sp24/projects/proj2/part-b/" title="See a list of every capture for this URL">1 capture</a><div class="r" title="Timespan for captures of this URL">10 Mar 2024</div></div>
        <div class="k">
          <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/" id="wm-graph-anchor">
            <div id="wm-ipp-sparkline" title="Explore captures for this URL" style="position: relative">
              <canvas id="wm-sparkline-canvas" width="725" height="27" border="0"></canvas>
            <div class="yt" style="display: none; width: 25px; height: 27px;"></div><div class="mt" style="display: none; width: 2px; height: 27px;"></div></div>
          </a>
        </div>
      </div>
    </div>
    <div class="n">
      <table>
        <tbody>
          <!-- NEXT/PREV MONTH NAV AND MONTH INDICATOR -->
          <tr class="m">
            <td class="b" nowrap="nowrap">Feb</td>
            <td class="c" id="displayMonthEl" title="You are here: 02:34:22 Mar 10, 2024">MAR</td>
            <td class="f" nowrap="nowrap">Apr</td>
          </tr>
          <!-- NEXT/PREV CAPTURE NAV AND DAY OF MONTH INDICATOR -->
          <tr class="d">
            <td class="b" nowrap="nowrap"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_prv_off.png" alt="Previous capture" width="14" height="16" border="0"></td>
            <td class="c" id="displayDayEl" style="width:34px;font-size:22px;white-space:nowrap;" title="You are here: 02:34:22 Mar 10, 2024">10</td>
            <td class="f" nowrap="nowrap"><img src="https://web-static.archive.org/_static/images/toolbar/wm_tb_nxt_off.png" alt="Next capture" width="14" height="16" border="0"></td>
          </tr>
          <!-- NEXT/PREV YEAR NAV AND YEAR INDICATOR -->
          <tr class="y">
            <td class="b" nowrap="nowrap">2023</td>
            <td class="c" id="displayYearEl" title="You are here: 02:34:22 Mar 10, 2024">2024</td>
            <td class="f" nowrap="nowrap">2025</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="r" style="display:flex;flex-flow:column nowrap;align-items:flex-end;justify-content:space-between;">
      <div id="wm-btns" style="text-align:right;height:23px;">
                <span class="xxs">
          <div id="wm-save-snapshot-success">success</div>
          <div id="wm-save-snapshot-fail">fail</div>
          <a id="wm-save-snapshot-open" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#" title="Share via My Web Archive" style="display: none;">
            <span class="iconochive-web"></span>
          </a>
          <a href="https://archive.org/account/login.php" title="Sign In" id="wm-sign-in" style="display: inline-block;">
            <span class="iconochive-person"></span>
          </a>
          <span id="wm-save-snapshot-in-progress" class="iconochive-web" style="display: none;"></span>
        </span>
                <a class="xxs" href="http://faq.web.archive.org/" title="Get some help using the Wayback Machine" style="top:-6px;"><span class="iconochive-question" style="color:rgb(87,186,244);font-size:160%;"></span></a>
        <a id="wm-tb-close" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#close" style="top:-2px;" title="Close the toolbar"><span class="iconochive-remove-circle" style="color:#888888;font-size:240%;"></span></a>
      </div>
      <div id="wm-share" class="xxs">
        <a href="https://web.archive.org/web/20240310023422/http://web.archive.org/screenshot/https://cs61c.org/sp24/projects/proj2/part-b/" id="wm-screenshot" title="screenshot" style="visibility: hidden;">
          <span class="wm-icon-screen-shot"></span>
        </a>
        <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#" id="wm-video" title="video">
          <span class="iconochive-movies"></span>
        </a>
        <a id="wm-share-facebook" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#" data-url="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/" title="Share on Facebook" style="margin-right:5px;" target="_blank"><span class="iconochive-facebook" style="color:#3b5998;font-size:160%;"></span></a>
        <a id="wm-share-twitter" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#" data-url="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/" title="Share on Twitter" style="margin-right:5px;" target="_blank"><span class="iconochive-twitter" style="color:#1dcaff;font-size:160%;"></span></a>
      </div>
      <div style="padding-right:2px;text-align:right;white-space:nowrap;">
        <a id="wm-expand" class="wm-btn wm-closed" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#expand" onclick="__wm.ex(event);return false;"><span id="wm-expand-icon" class="iconochive-down-solid"></span> <span class="xxs" style="font-size:80%;">About this capture</span></a>
      </div>
    </div>
  </div>
    <div id="wm-capinfo" style="border-top:1px solid #777;display:none; overflow: hidden">
        <div id="wm-capinfo-notice" source="api"></div>
                <div id="wm-capinfo-collected-by">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center">COLLECTED BY</div>
    <div style="padding:3px;position:relative" id="wm-collected-by-content">
      <div style="display:inline-block;vertical-align:top;width:49%;">
			<span class="c-logo" style="background-image:url(https://archive.org/services/img/save-page-now-outlinks)"></span>
		<div>Collection: <a style="color:#33f;" href="https://archive.org/details/save-page-now-outlinks" target="_new"><span class="wm-title">Save Page Now Outlinks</span></a></div>
	      </div>
    </div>
    </div>
    <div id="wm-capinfo-timestamps">
    <div style="background-color:#666;color:#fff;font-weight:bold;text-align:center" title="Timestamps for the elements of this page">TIMESTAMPS</div>
    <div>
      <div id="wm-capresources" style="margin:0 5px 5px 5px;max-height:250px;overflow-y:scroll !important"></div>
      <div id="wm-capresources-loading" style="text-align:left;margin:0 20px 5px 5px;display:none"><img src="https://web-static.archive.org/_static/images/loading.gif" alt="loading"></div>
    </div>
    </div>
  </div></div></div><link rel="stylesheet" type="text/css" href="./Part B _ CS 61C Spring 2024_files/banner-styles.css"><link rel="stylesheet" type="text/css" href="./Part B _ CS 61C Spring 2024_files/iconochive.css"><div class="wb-autocomplete-suggestions "></div></template>
</div><div id="wm-ipp-print">The Wayback Machine - https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/</div>
<script type="text/javascript">//<![CDATA[
__wm.bt(725,27,25,2,"web","https://cs61c.org/sp24/projects/proj2/part-b/","20240310023422",1996,"https://web-static.archive.org/_static/",["https://web-static.archive.org/_static/css/banner-styles.css?v=S1zqJCYt","https://web-static.archive.org/_static/css/iconochive.css?v=qtvMKcIJ"], false);
  __wm.rw(1);
//]]></script>
<!-- END WAYBACK TOOLBAR INSERT -->
 
<nav class="navbar navbar-expand-lg navbar-dark mb-4">
<div class="container">
<a class="navbar-brand" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/">
<img class="d-inline-block me-2 rounded" height="48" width="48" src="./Part B _ CS 61C Spring 2024_files/icon-small.png" alt="outline of square computer chip with cs61c label">
<span class="align-middle">CS 61C Spring 2024</span>
</a>
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent" aria-controls="navbarContent" aria-expanded="false" aria-label="Toggle Navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="collapse navbar-collapse" id="navbarContent">
<ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/calendar/">Calendar</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/exam/">Exam</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/staff/">Staff</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/policies/">Policies</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/resources/">Resources</a>
</li>
<li class="nav-item dropdown">
<a class="nav-link dropdown-toggle" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#" id="navbarLinksDropdownToggle" role="button" data-bs-toggle="dropdown" aria-expanded="false">Quick Links</a>
<ul class="dropdown-menu p-0" aria-labelledby="navbarLinksDropdownToggle">
<li><a class="dropdown-item nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/pdfs/resources/reference-card.pdf">Reference Card</a></li>
<li><a class="dropdown-item nav-link" href="https://web.archive.org/web/20240310023422/https://oh.cs61c.org/">OH Queue</a></li>
<li><a class="dropdown-item nav-link" href="https://web.archive.org/web/20240310023422/https://venus.cs61c.org/">Venus</a></li>
<li><a class="dropdown-item nav-link" href="https://web.archive.org/web/20240310023422/https://inst.eecs.berkeley.edu/~cs61c/archives.html">Past Semesters</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>
<main class="mb-4">
<section class="section">
<div class="container">
<div class="row spec">
<nav class="col-md-3 d-print-none sticky-md-top nav-wrapper" aria-label="table of contents">
<ul class="nav flex-column">
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/">Project 2: CS61Classify</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-a/">Part A</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/">Part B</a>
<div id="toc-wrapper"><ul class="toc-list nav flex-column"><li class="nav-item active"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#task-6-matrix-multiplication" class="nav-link node-name--H2  active">Task 6: Matrix Multiplication</a><ul class="toc-list nav flex-column is-collapsible"><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#conceptual-overview-storing-matrices" class="nav-link node-name--H3 ">Conceptual Overview: Storing Matrices</a></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#conceptual-overview-matrix-multiplication" class="nav-link node-name--H3 ">Conceptual Overview: Matrix Multiplication</a></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#your-task" class="nav-link node-name--H3 ">Your Task</a></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#testing-and-debugging" class="nav-link node-name--H3 ">Testing and debugging</a></li></ul></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#task-7-read-matrix" class="nav-link node-name--H2 ">Task 7: Read Matrix</a><ul class="toc-list nav flex-column is-collapsible is-collapsed"><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#conceptual-overview-matrix-files" class="nav-link node-name--H3 ">Conceptual Overview: Matrix Files</a></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#reading-matrix-files" class="nav-link node-name--H3 ">Reading matrix files</a></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#your-task-1" class="nav-link node-name--H3 ">Your Task</a></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#testing-and-debugging-1" class="nav-link node-name--H3 ">Testing and debugging</a></li></ul></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#task-8-write-matrix" class="nav-link node-name--H2 ">Task 8: Write Matrix</a><ul class="toc-list nav flex-column is-collapsible is-collapsed"><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#testing-and-debugging-2" class="nav-link node-name--H3 ">Testing and debugging</a></li></ul></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#task-9-classify" class="nav-link node-name--H2 ">Task 9: Classify</a><ul class="toc-list nav flex-column is-collapsible is-collapsed"><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#testing-and-debugging-3" class="nav-link node-name--H3 ">Testing and debugging</a></li></ul></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#task-10-partner-feedback-form" class="nav-link node-name--H2 ">Task 10: Partner/Feedback Form</a></li><li class="nav-item"><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/#submission-and-grading" class="nav-link node-name--H2 ">Submission and Grading</a></li></ul></div>
</li>
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/function-definitions/">Appendix: Function Definitions</a>
</li>
<li class="nav-item">
<a class="nav-link" href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/calling-convention/">Appendix: Calling Convention</a>
</li>
</ul>
</nav>
<div id="toc-content-wrapper" class="content col-md-9">
<h1>Part B</h1>
<div class="alert alert-info">
<p>Lab 4 is required for Project 2B, and lectures 8-11, Discussion 3-4, and Homework 4-5 are highly recommended.</p>
</div>
<p>In this part, you will implement a matrix multiplication function and file operations to read pictures of handwritten digits. Then you will use your math functions from the previous part to determine what digit is in the picture.</p>
<p>If you are curious how the machine learning algorithm works, you can expand the Neural Networks section below. This is optional and not required to finish the project.</p>
<details>
<summary>Optional: Neural Networks</summary>
<p>At a basic level, a neural networks tries to approximate a (non-linear) function that maps your input into a desired output. A basic neuron consists of a weighted linear combination of the input, followed by a non-linearity -- for example, a threshold. Consider the following neuron, which implements the logical <code>AND</code> operation:</p>
<p><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/neuron.png" target="_blank"><img src="./Part B _ CS 61C Spring 2024_files/neuron.png"></a></p>
<p>It is easy to see that for A=0, B=0, the linear combination 0*0.6 + 0*0.6 = 0, which is less than the threshold of 1 and will result in a 0 output. With an input A=0, B=1 or A=1, B=0 the linear combination will results in 1*0.6 + 0*0.6 = 0.6, which is less than 1 and result in a 0 output. Similarly, A=1, B=1 will result in 1*0.6+1*0.6=1.2, which is greater than the threshold and will result in a 1 output! What is interesting is that the simple neuron operation can also be described as an inner product between the vector [A,B]^T and the weights vector [0.6,0.6]^T followed by as thresholding, non-linear operation.</p>
<p>More complex functions can not be described by a simple neuron alone. We can extend the system into a network of neurons, in order to approximate the complex functions. For example, the following 2 layer network approximates the logical function <code>XOR</code>:</p>
<p><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/XOR.png" target="_blank"><img src="./Part B _ CS 61C Spring 2024_files/XOR.png"></a></p>
<p>The above is a 2 layer network. The network takes 2 inputs, computes 2 intermediate values, and finally computes a single final output.</p>
<p>It can be written as matrix multiplications with matrices <code>m_0</code> and <code>m_1</code> with thresholding operations in between as shown below:</p>
<p><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/mtx.png" target="_blank"><img src="./Part B _ CS 61C Spring 2024_files/mtx.png"></a></p>
<p>Convince yourself that this implements an <code>XOR</code> for the appropriate inputs!</p>
<p>You are probably wondering how the weights of the network were determined? This is beyond the scope of this project, and we would encourage you to take advanced classes in numerical linear algebra, signal processing, machine learning and optimization. We will only say that the weights can be trained by giving the network pairs of correct inputs and outputs and changing the weights such that the error between the outputs of the network and the correct outputs is minimized. Learning the weights is called: "Training". Using the weights on inputs is called "Inference". We will only perform inference, and you will be given weights that were pre-trained by your dedicated TA's.</p>
<p>In this project we will implement a similar, but slightly more complex network which is able to classify handwritten digits. As inputs, we will use the <a href="https://web.archive.org/web/20240310023422/http://yann.lecun.com/exdb/mnist/">MNIST</a> data set, which is a dataset of 60,000 28x28 images containing handwritten digits ranging from 0-9. We will treat these images as "flattened" input vectors of size 784 (<code>= 28 * 28</code>). In a similar way to the example before, we will perform matrix multiplications with pre-trained weight matrices <code>m_0</code> and <code>m_1</code>. Instead of thresholding we will use two different non-linearities: The <code>ReLU</code> and <code>ArgMax</code> functions. Details will be provided in descriptions of the individual tasks.</p>
<p><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/MNIST.png" target="_blank"><img src="./Part B _ CS 61C Spring 2024_files/MNIST.png"></a></p>
</details>
<h2 id="task-6-matrix-multiplication">Task 6: Matrix Multiplication</h2>
<h3 id="conceptual-overview-storing-matrices">Conceptual Overview: Storing Matrices</h3>
<p>A matrix is a 2-dimensional array of integers. In this project, matrices will be stored as an integer array in row-major order. Row-major order means we store each row of the matrix consecutively in memory as a 1-dimensional integer array.</p>
<p><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/row_major.jpg" target="_blank"><img src="./Part B _ CS 61C Spring 2024_files/row_major.jpg"></a></p>
<h3 id="conceptual-overview-matrix-multiplication">Conceptual Overview: Matrix Multiplication</h3>
<p>The matrix multiplication function takes in two integer matrices A (dimension <em>n</em> × <em>m</em>) and B (dimension <em>m</em> × <em>k</em>) and outputs an integer matrix C (dimension <em>n</em> × <em>k</em>).</p>
<p>To calculate the entry at row <em>i</em>, column <em>j</em> of C, take the dot product of the <em>i</em>th row of A and the <em>j</em>th column of B. Note that this can be done by calling the <code>dot</code> function with the proper strides.</p>
<p><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/task6-1.svg" target="_blank"><img src="./Part B _ CS 61C Spring 2024_files/task6-1.svg"></a></p>
<p>For example, in the above diagram, we are computing the entry in row 1, column 1 of C by taking the dot product of the 1st row of A and the 1st row of B.</p>
<p><a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/task6-2.svg" target="_blank"><img src="./Part B _ CS 61C Spring 2024_files/task6-2.svg"></a></p>
<p>In the above diagram, we are computing the entry in row 2, column 2 of C. Note that we are changing the pointer to the start of the array in order to access later rows and columns.</p>
<h3 id="your-task">Your Task</h3>
<p>Fill in the <code>matmul</code> function in <code>src/matmul.s</code>.</p>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>matmul</code>: Task 6.</td>
</tr>
<tr>
<td rowspan="7" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int *</code></td>
<td>A pointer to the start of the first matrix A (stored as an integer array in row-major order).</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int</code></td>
<td>The number of rows (height) of the first matrix A.</td>
</tr>
<tr>
<td><code>a2</code></td>
<td><code>int</code></td>
<td>The number of columns (width) of the first matrix A.</td>
</tr>
<tr>
<td><code>a3</code></td>
<td><code>int *</code></td>
<td>A pointer to the start of the second matrix B (stored as an integer array in row-major order).</td>
</tr>
<tr>
<td><code>a4</code></td>
<td><code>int</code></td>
<td>The number of rows (height) of the second matrix B.</td>
</tr>
<tr>
<td><code>a5</code></td>
<td><code>int</code></td>
<td>The number of columns (width) of the second matrix B.</td>
</tr>
<tr>
<td><code>a6</code></td>
<td><code>int *</code></td>
<td>A pointer to the start of an integer array where the result C should be stored. You can assume this memory has been allocated (but is uninitialized) and has enough space to store C.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td colspan="3">None</td>
</tr>
</tbody>
</table>
<p>If the input is malformed in the following ways, put the appropriate return code into <code>a0</code> and run <code>j exit</code> to quit the program.</p>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 85%;">
</colgroup>
<tbody>
<tr>
<td><b>Return code</b></td>
<td><b>Exception</b></td>
</tr>
<tr>
<td>38</td>
<td>The height or width of either matrix is less than 1.</td>
</tr>
<tr>
<td>38</td>
<td>The number of columns (width) of the first matrix A is not equal to the number of rows (height) of the second matrix B.</td>
</tr>
</tbody>
</table>
<h3 id="testing-and-debugging">Testing and debugging</h3>
<p>To test your function, in your local terminal, run <code>bash test.sh test_matmul</code>.</p>
<p>To debug your function, in your Venus terminal, run <code>cd /vmfs/test-src</code>, then run a VDB command to start the debugger:</p>
<pre class="z-code"><code><span class="z-text z-plain">vdb test_matmul_length_1.s
vdb test_matmul_negative_dim_m0_x.s
vdb test_matmul_negative_dim_m0_y.s
vdb test_matmul_negative_dim_m1_x.s
vdb test_matmul_negative_dim_m1_y.s
vdb test_matmul_nonsquare_1.s
vdb test_matmul_nonsquare_2.s
vdb test_matmul_square.s
vdb test_matmul_unmatched_dims.s
vdb test_matmul_zero_dim_m0.s
vdb test_matmul_zero_dim_m1.s
</span></code></pre>
<p><strong>Note</strong>: The error cases will not error on Venus and will only error when running the tests via <code>bash test.sh</code>.</p>
<p>Debugging advice:</p>
<ul>
<li>Since you'll need to call the <code>dot</code> function in <code>matmul</code>, make sure to follow calling convention! See the calling convention appendix for more details. In particular, as soon as you call <code>dot</code>, the <code>dot</code> function is allowed to change all the t0-t6 and a1-a7 registers, so when the <code>dot</code> function returns, you need to assume that those registers contain <em>garbage</em>.</li>
<li>You can use the functions described in the <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/calling-convention/#randomizing-preserved-registers">calling convention appendix</a> to debug calling convention errors.</li>
<li>Watch the <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/#debugging-videos">debugging videos</a>!</li>
</ul>
<h2 id="task-7-read-matrix">Task 7: Read Matrix</h2>
<h3 id="conceptual-overview-matrix-files">Conceptual Overview: Matrix Files</h3>
<p>Remember from Task 6 that matrices are stored in memory as an integer array in row-major order.</p>
<p>Matrices are stored in files as a consecutive sequence of 4-byte integers. The first and second integers in the file indicate the number of rows and columns in the matrix, respectively. The rest of the integers store the elements in the matrix in row-major order.</p>
<p>All the matrix files end in a <code>.bin</code> file extension and are in the <code>tests</code> folder. To view matrix files, you can run <code>xxd -e matrix_file.bin</code>, replacing <code>matrix_file.bin</code> with the matrix file you want to read.</p>
<h3 id="reading-matrix-files">Reading matrix files</h3>
<p>In your local terminal (not the Venus) terminal, navigate to the <code>tests</code> folder (e.g. <code>cd tests</code>), then navigate to the folder that contains the files you want to read. In this example, we'll <code>cd read-matrix-1</code> to check the first test.</p>
<p><code>ls</code> to see the files in this directory. There should be one file, <code>input.bin</code>. Run <code>xxd -e input.bin</code> to see the contents of this file. The output should look something like this:</p>
<pre class="z-code"><code><span class="z-text z-plain">00000000: 00000003 00000003 00000001 00000002  ................
00000010: 00000003 00000004 00000005 00000006  ................
00000020: 00000007 00000008 00000009           ............
</span></code></pre>
<p>The left-most column indexes the bytes in the file (e.g. the third row starts at the <code>0x20</code>th byte of the file). The dots on the right display the bytes in the file as ASCII, but these bytes don't correspond to printable ASCII characters so only dot placeholders appear.</p>
<p>The actual contents of the file are listed in 4-byte blocks, 4 per row. The first row has the numbers 3 (row count), 3 (column count), 1 (first element), and 2 (second element). This is a 3x3 matrix with elements [1, 2, 3, 4, 5, 6, 7, 8, 9].</p>
<h3 id="your-task-1">Your Task</h3>
<p>Fill in the <code>read_matrix</code> function in <code>src/read_matrix.s</code>. This function should do the following:</p>
<ol>
<li>Open the file with read permissions. The filepath is provided as an argument (<code>a0</code>).</li>
<li>Read the number of rows and columns from the file (remember: these are the first two integers in the file). Store these integers in memory at the provided pointers (<code>a1</code> for rows and <code>a2</code> for columns).</li>
<li>Allocate space on the heap to store the matrix. (Hint: Use the number of rows and columns from the previous step to determine how much space to allocate.)</li>
<li>Read the matrix from the file to the memory allocated in the previous step.</li>
<li>Close the file.</li>
<li>Return a pointer to the matrix in memory.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>read_matrix</code>: Task 7.</td>
</tr>
<tr>
<td rowspan="3" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>char *</code></td>
<td>A pointer to the filename string.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int *</code></td>
<td>A pointer to an integer which will contain the number of rows. You can assume this points to allocated memory.</td>
</tr>
<tr>
<td><code>a2</code></td>
<td><code>int *</code></td>
<td>A pointer to an integer which will contain the number of columns. You can assume this points to allocated memory.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int *</code></td>
<td>A pointer to the matrix in memory.</td>
</tr>
</tbody>
</table>
<p>If the input is malformed in the following ways, put the appropriate return code into <code>a0</code> and run <code>j exit</code> to quit the program.</p>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 85%;">
</colgroup>
<tbody>
<tr>
<td><b>Return code</b></td>
<td><b>Exception</b></td>
</tr>
<tr>
<td>26</td>
<td><code>malloc</code> returns an error.</td>
</tr>
<tr>
<td>27</td>
<td><code>fopen</code> returns an error.</td>
</tr>
<tr>
<td>28</td>
<td><code>fclose</code> returns an error.</td>
</tr>
<tr>
<td>29</td>
<td><code>fread</code> does not read the correct number of bytes.</td>
</tr>
</tbody>
</table>
<p>To implement this function, you will need to call some utility functions. A complete set of function definitions can be found in the appendix. The relevant function definitions for this task are provided below (expand the section to see them).</p>
<details>
<summary>Task 7: Relevant Function Definitions</summary>
<ol>
<li>Open the file with read permissions. The filepath is provided as an argument (<code>a0</code>).</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>fopen</code>: Open a file for reading or writing.</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>char *</code></td>
<td>A pointer to the filename string.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int</code></td>
<td>Permission bits. 0 for read-only, 1 for write-only.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>A file descriptor. This integer can be used in other file operation functions to refer to the opened file. If opening the file failed, this value is -1.</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>Read the number of rows and columns from the file (remember: these are the first two integers in the file). Store these integers in memory at the provided pointers (<code>a1</code> for rows and <code>a2</code> for columns).</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>fread</code>: Read bytes from a file to a buffer in memory. Subsequent reads will read from later parts of the file.</td>
</tr>
<tr>
<td rowspan="3" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The file descriptor of the file we want to read from, previously returned by <code>fopen</code>.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int*</code></td>
<td>A pointer to the buffer where the read bytes will be stored.</td>
</tr>
<tr>
<td><code>a2</code></td>
<td><code>int</code></td>
<td>The number of bytes to read from the file.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The number of bytes actually read from the file. If this differs from the argument provided in <code>a2</code>, then we either hit the end of the file or there was an error.</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>Allocate space on the heap to store the matrix. (Hint: Use the number of rows and columns from the previous step to determine how much space to allocate.)</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>malloc</code>: Allocates heap memory.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The size of the memory that we want to allocate (in bytes).</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>void *</code></td>
<td>A pointer to the allocated memory. If the allocation failed, this value is 0.</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>
<p>Read the matrix from the file to the memory allocated in the previous step. (Use <code>fread</code> from above.)</p>
</li>
<li>
<p>Close the file.</p>
</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>fclose</code>: Close a file, saving any writes we have made to the file.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The file descriptor of the file we want to close, previously returned by <code>fopen</code>.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>0 on success, and -1 otherwise.</td>
</tr>
</tbody>
</table>
<ol start="6">
<li>Return a pointer to the matrix in memory.</li>
</ol>
</details>
<h3 id="testing-and-debugging-1">Testing and debugging</h3>
<p>To test your function, in your local terminal, run <code>bash test.sh test_read_matrix</code>.</p>
<p>To debug your function, in your Venus terminal, run <code>cd /vmfs/test-src</code>, then run a VDB command to start the debugger:</p>
<pre class="z-code"><code><span class="z-text z-plain">vdb test_read_1.s
vdb test_read_2.s
vdb test_read_3.s
vdb test_read_fail_fclose.s
vdb test_read_fail_fopen.s
vdb test_read_fail_fread.s
vdb test_read_fail_malloc.s
</span></code></pre>
<p><strong>Note</strong>: The error cases will not error on Venus and will only error when running the tests via <code>bash test.sh</code>.</p>
<p>As a reminder, you can use the functions described in the <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/calling-convention/#randomizing-preserved-registers">calling convention appendix</a> to debug calling convention errors. We also have <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/#debugging-videos">debugging videos</a> that may help you debug these errors.</p>
<h2 id="task-8-write-matrix">Task 8: Write Matrix</h2>
<p>Fill in the <code>write_matrix</code> function in <code>src/write_matrix.s</code>. This function should do the following:</p>
<ol>
<li>Open the file with write permissions. The filepath is provided as an argument.</li>
<li>Write the number of rows and columns to the file. (Hint: The <code>fwrite</code> function expects a pointer to data in memory, so you should first store the data to memory, and then pass a pointer to the data to <code>fwrite</code>.)</li>
<li>Write the data to the file.</li>
<li>Close the file.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>write_matrix</code>: Task 8.</td>
</tr>
<tr>
<td rowspan="4" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>char *</code></td>
<td>A pointer to the filename string.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int *</code></td>
<td>A pointer to the matrix in memory (stored as an integer array).</td>
</tr>
<tr>
<td><code>a2</code></td>
<td><code>int</code></td>
<td>The number of rows in the matrix.</td>
</tr>
<tr>
<td><code>a3</code></td>
<td><code>int</code></td>
<td>The number of columns in the matrix.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td colspan="3">None</td>
</tr>
</tbody>
</table>
<p>If the input is malformed in the following ways, put the appropriate return code into <code>a0</code> and run <code>j exit</code> to quit the program.</p>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 85%;">
</colgroup>
<tbody>
<tr>
<td><b>Return code</b></td>
<td><b>Exception</b></td>
</tr>
<tr>
<td>27</td>
<td><code>fopen</code> returns an error.</td>
</tr>
<tr>
<td>30</td>
<td><code>fwrite</code> does not write the correct number of bytes.</td>
</tr>
<tr>
<td>28</td>
<td><code>fclose</code> returns an error.</td>
</tr>
</tbody>
</table>
<p>To implement this function, you will need to call some utility functions. A complete set of function definitions can be found in the appendix. The relevant function definitions for this task are provided below (expand the section to see them).</p>
<details>
<summary>Task 8: Relevant Function Definitions</summary>
<ol>
<li>Open the file with write permissions. The filepath is provided as an argument.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>fopen</code>: Open a file for reading or writing.</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>char *</code></td>
<td>A pointer to the filename string.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int</code></td>
<td>Permission bits. 0 for read-only, 1 for write-only.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>A file descriptor. This integer can be used in other file operation functions to refer to the opened file. If opening the file failed, this value is -1.</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>
<p>Write the number of rows and columns to the file. (Hint: The <code>fwrite</code> function expects a pointer to data in memory, so you should first store the data to memory, and then pass a pointer to the data to <code>fwrite</code>.)</p>
</li>
<li>
<p>Write the data to the file.</p>
</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>fwrite</code>: Write bytes from a buffer in memory to a file. Subsequent writes append to the end of the existing file.</td>
</tr>
<tr>
<td rowspan="4" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The file descriptor of the file we want to write to, previously returned by <code>fopen</code>.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>void *</code></td>
<td>A pointer to a buffer containing what we want to write to the file.</td>
</tr>
<tr>
<td><code>a2</code></td>
<td><code>int</code></td>
<td>The number of elements to write to the file.</td>
</tr>
<tr>
<td><code>a3</code></td>
<td><code>int</code></td>
<td>The size of each element. In total, <code>a2</code> × <code>a3</code> bytes are written.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The number of items actually written to the file. If this differs from the number of items specified (<code>a2</code>), then we either hit the end of the file or there was an error.</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>Close the file.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>fclose</code>: Close a file, saving any writes we have made to the file.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The file descriptor of the file we want to close, previously returned by <code>fopen</code>.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>0 on success, and -1 otherwise.</td>
</tr>
</tbody>
</table>
</details>
<h3 id="testing-and-debugging-2">Testing and debugging</h3>
<p>To test your function, in your local terminal, run <code>bash test.sh test_write_matrix</code>.</p>
<p>To debug your function, in your Venus terminal, run <code>cd /vmfs/test-src</code>, then run a VDB command to start the debugger:</p>
<pre class="z-code"><code><span class="z-text z-plain">vdb test_write_1.s
vdb test_write_fail_fclose.s
vdb test_write_fail_fopen.s
vdb test_write_fail_fwrite.s
</span></code></pre>
<p><strong>Note</strong>: The error cases will not error on Venus and will only error when running the tests via <code>bash test.sh</code>.</p>
<p>As a reminder, you can use the functions described in the <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/calling-convention/#randomizing-preserved-registers">calling convention appendix</a> to debug calling convention errors. We also have <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/#debugging-videos">debugging videos</a> that may help you debug these errors.</p>
<h2 id="task-9-classify">Task 9: Classify</h2>
<p>Recall the <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/part-b/">neural net</a> that we're trying to create. In this task, you will use functions from the previous tasks in order to complete the classification function, located in <code>src/classify.s</code>.</p>
<p>Fill in the <code>classify</code> function in <code>src/classify.s</code>. This function should do the following:</p>
<ol>
<li>Read three matrices <code>m0</code>, <code>m1</code>, and <code>input</code> from files. Their filepaths are provided as arguments. You will need to allocate space for the pointer arguments to <code>read_matrix</code>, since that function is expecting a pointer to allocated memory.</li>
<li>Compute <code>h = matmul(m0, input)</code>. You will probably need to <code>malloc</code> space to fit <code>h</code>.</li>
<li>Compute <code>h = relu(h)</code>. Remember that <code>relu</code> is performed in-place.</li>
<li>Compute <code>o = matmul(m1, h)</code> and write the resulting matrix to the <code>output</code> file. The <code>output</code> filepath is provided as an argument.</li>
<li>Compute and return <code>argmax(o)</code>. If the print argument is set to 0, then also print out <code>argmax(o)</code> and a newline character.</li>
<li>Free any data you allocated with <code>malloc</code>. This includes any heap blocks allocated from calling <code>read_matrix</code>.</li>
<li>Remember to put the return value, <code>argmax(o)</code>, in the appropriate register before returning.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 19%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 57%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>classify</code>: Task 9.</td>
</tr>
<tr>
<td rowspan="7" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td><code>argc</code> (the number of arguments provided)</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>char **</code></td>
<td><code>argv</code>, a pointer to an array of argument strings (<code>char *</code>)</td>
</tr>
<tr>
<td><code>a1[1]</code> = <code>*(a1 + 4)</code></td>
<td><code>char *</code></td>
<td>A pointer to the filepath string of the first matrix file <code>m0</code>.</td>
</tr>
<tr>
<td><code>a1[2]</code> = <code>*(a1 + 8)</code></td>
<td><code>char *</code></td>
<td>A pointer to the filepath string of the second matrix file <code>m1</code>.</td>
</tr>
<tr>
<td><code>a1[3]</code> = <code>*(a1 + 12)</code></td>
<td><code>char *</code></td>
<td>A pointer to the filepath string of the input matrix file <code>input</code>.</td>
</tr>
<tr>
<td><code>a1[4]</code> = <code>*(a1 + 16)</code></td>
<td><code>char *</code></td>
<td>A pointer to the filepath string of the output file.</td>
</tr>
<tr>
<td><code>a2</code></td>
<td><code>int</code></td>
<td>If set to 0, print out the classification. Otherwise, do not print anything.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The classification (see above).</td>
</tr>
</tbody>
</table>
<p>If the input is malformed in the following ways, put the appropriate return code into <code>a0</code> and run <code>j exit</code> to quit the program.</p>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 85%;">
</colgroup>
<tbody>
<tr>
<td><b>Return code</b></td>
<td><b>Exception</b></td>
</tr>
<tr>
<td>26</td>
<td><code>malloc</code> returns an error.</td>
</tr>
<tr>
<td>31</td>
<td>There are an incorrect number of command line arguments. Note that there are 5 arguments to the program, because <code>a1[0]</code> is reserved for the name of the program.</td>
</tr>
</tbody>
</table>
<p>To implement this function, you will need to call some utility functions. A complete set of function definitions can be found in the appendix. The relevant function definitions for this task are provided below (expand the section to see them).</p>
<details>
<summary>Task 9: Relevant Function Definitions</summary>
<ol>
<li>Read three matrices <code>m0</code>, <code>m1</code>, and <code>input</code> from files. Their filepaths are provided as arguments. You will need to allocate space for the pointer arguments to <code>read_matrix</code>, since that function is expecting a pointer to allocated memory.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>read_matrix</code>: Task 7.</td>
</tr>
<tr>
<td rowspan="3" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>char *</code></td>
<td>A pointer to the filename string.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int *</code></td>
<td>A pointer to an integer which will contain the number of rows. You can assume this points to allocated memory.</td>
</tr>
<tr>
<td><code>a2</code></td>
<td><code>int *</code></td>
<td>A pointer to an integer which will contain the number of columns. You can assume this points to allocated memory.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int *</code></td>
<td>A pointer to the matrix in memory.</td>
</tr>
</tbody>
</table>
<ol start="2">
<li>Compute <code>h = matmul(m0, input)</code>. You will probably need to <code>malloc</code> space to fit <code>h</code>.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>malloc</code>: Allocates heap memory.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The size of the memory that we want to allocate (in bytes).</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>void *</code></td>
<td>A pointer to the allocated memory. If the allocation failed, this value is 0.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>matmul</code>: Task 6.</td>
</tr>
<tr>
<td rowspan="7" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int *</code></td>
<td>A pointer to the start of the first matrix A (stored as an integer array in row-major order).</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int</code></td>
<td>The number of rows (height) of the first matrix A.</td>
</tr>
<tr>
<td><code>a2</code></td>
<td><code>int</code></td>
<td>The number of columns (width) of the first matrix A.</td>
</tr>
<tr>
<td><code>a3</code></td>
<td><code>int *</code></td>
<td>A pointer to the start of the second matrix B (stored as an integer array in row-major order).</td>
</tr>
<tr>
<td><code>a4</code></td>
<td><code>int</code></td>
<td>The number of rows (height) of the second matrix B.</td>
</tr>
<tr>
<td><code>a5</code></td>
<td><code>int</code></td>
<td>The number of columns (width) of the second matrix B.</td>
</tr>
<tr>
<td><code>a6</code></td>
<td><code>int *</code></td>
<td>A pointer to the start of an integer array where the result C should be stored. You can assume this memory has been allocated (but is uninitialized) and has enough space to store C.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td colspan="3">None</td>
</tr>
</tbody>
</table>
<ol start="3">
<li>Compute <code>h = relu(h)</code>. Remember that <code>relu</code> is performed in-place.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>relu</code>: Task 2.</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int *</code></td>
<td>A pointer to the start of the integer array.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int</code></td>
<td>The number of integers in the array. You can assume that this argument matches the actual length of the integer array.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td colspan="3">None</td>
</tr>
</tbody>
</table>
<ol start="4">
<li>Compute <code>o = matmul(m1, h)</code> and write the resulting matrix to the <code>output</code> file. The <code>output</code> filepath is provided as an argument.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>write_matrix</code>: Task 8.</td>
</tr>
<tr>
<td rowspan="4" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>char *</code></td>
<td>A pointer to the filename string.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int *</code></td>
<td>A pointer to the matrix in memory (stored as an integer array).</td>
</tr>
<tr>
<td><code>a2</code></td>
<td><code>int</code></td>
<td>The number of rows in the matrix.</td>
</tr>
<tr>
<td><code>a3</code></td>
<td><code>int</code></td>
<td>The number of columns in the matrix.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td colspan="3">None</td>
</tr>
</tbody>
</table>
<ol start="5">
<li>Compute and return <code>argmax(o)</code>. If the print argument is set to 0, then also print out <code>argmax(o)</code> and a newline character.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>argmax</code>: Task 3.</td>
</tr>
<tr>
<td rowspan="2" style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int *</code></td>
<td>A pointer to the start of the integer array.</td>
</tr>
<tr>
<td><code>a1</code></td>
<td><code>int</code></td>
<td>The number of integers in the array. You can assume that this argument matches the actual length of the integer array.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The index of the largest element. If the largest element appears multiple times, return the smallest index.</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>print_int</code>: Prints an integer.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>int</code></td>
<td>The integer to print.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td colspan="3">None</td>
</tr>
</tbody>
</table>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>print_char</code>: Prints a character.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>char</code></td>
<td>The character to print. You can provide the ASCII code or put the character directly in the register like <code>li t0 '\n'</code>.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td colspan="3">None</td>
</tr>
</tbody>
</table>
<ol start="6">
<li>Free any data you allocated with <code>malloc</code>. This includes any heap blocks allocated from calling <code>read_matrix</code>.</li>
</ol>
<table>
<colgroup>
<col span="1" style="width: 15%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 9%;">
<col span="1" style="width: 67%;">
</colgroup>
<tbody>
<tr>
<td colspan="4"><code>free</code>: Frees heap memory.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Arguments</b></td>
<td><code>a0</code></td>
<td><code>void *</code></td>
<td>A pointer to the allocated memory to be freed.</td>
</tr>
<tr>
<td style="vertical-align: middle;"><b>Return values</b></td>
<td colspan="3">None</td>
</tr>
</tbody>
</table>
<ol start="7">
<li>Remember to put the return value, <code>argmax(o)</code>, in the appropriate register before returning.</li>
</ol>
</details>
<h3 id="testing-and-debugging-3">Testing and debugging</h3>
<p>To test your function, in your local terminal, run <code>bash test.sh test_classify</code>.</p>
<p>To debug your function, in your Venus terminal, run <code>cd /vmfs/test-src</code>, then run a VDB command to start the debugger:</p>
<pre class="z-code"><code><span class="z-text z-plain">vdb test_classify_1_silent.s ../tests/classify-1/m0.bin ../tests/classify-1/m1.bin ../tests/classify-1/input.bin ../tests/classify-1/output.bin
vdb test_classify_2_print.s ../tests/classify-2/m0.bin ../tests/classify-2/m1.bin ../tests/classify-2/input.bin ../tests/classify-2/output.bin
vdb test_classify_3_print.s ../tests/classify-3/m0.bin ../tests/classify-3/m1.bin ../tests/classify-3/input.bin ../tests/classify-3/output.bin
vdb test_classify_fail_malloc.s ../tests/classify-1/m0.bin ../tests/classify-1/m1.bin ../tests/classify-1/input.bin ../tests/classify-1/output.bin
vdb test_classify_not_enough_args.s
</span></code></pre>
<p><strong>Note</strong>: The error cases will not error on Venus and will only error when running the tests via <code>bash test.sh</code>.</p>
<p>Once you have classify running, you can run <code>bash test.sh test_chain</code>. This runs your classification function twice to make sure you properly followed calling convention.</p>
<p>As a reminder, you can use the functions described in the <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/calling-convention/#randomizing-preserved-registers">calling convention appendix</a> to debug calling convention errors. We also have <a href="https://web.archive.org/web/20240310023422/https://cs61c.org/sp24/projects/proj2/#debugging-videos">debugging videos</a> that may help you debug these errors.</p>
<p>To debug the chain test, run <code>cd /vmfs/test-src</code>, then run a VDB command to start the debugger:</p>
<pre class="z-code"><code><span class="z-text z-plain">vdb ../tests/chain-1/chain.s
</span></code></pre>
<h2 id="task-10-partner-feedback-form">Task 10: Partner/Feedback Form</h2>
<p>Congratulations on finishing the project! We'd love to hear your feedback on what can be improved for future semesters.</p>
<p>Please fill out this <a href="https://web.archive.org/web/20240310023422/https://docs.google.com/forms/d/e/1FAIpQLSeLHhTGw_6vXjtfkmD7uzqdHc2pe51q0Fb2GNJEfVYWetatwg/viewform">short form</a>, where you can offer your thoughts on the project and (if applicable) your partnership. Any feedback you provide won't affect your grade, so feel free to be honest and constructive.</p>
<h2 id="submission-and-grading">Submission and Grading</h2>
<p>Submit your code to the Project 2B assignment on Gradescope.</p>
<p>To ensure the autograder runs correctly, do not add any <code>.import</code> statements to the starter code. Also, make sure there are no <code>ecall</code> instructions in your code.</p>
</div>
</div>
</div>
</section>
</main>
<footer>
<div class="container border-top pt-4 mb-5">
<div class="row">
<div class="col">
<div id="dark-toggle-wrapper" class="">
<div class="form-check form-switch">
<input id="inputDarkToggle" class="form-check-input" type="checkbox">
<label class="form-check-label" for="inputDarkToggle">
Dark Mode
<a id="buttonDarkToggleReset" class="d-none" href="javascript:void(0);">(reset)</a>
</label>
</div>
</div>
</div>
</div>
</div>
</footer>
<script>
  

  document.addEventListener("DOMContentLoaded", function() {
    initToC();
  });
</script>



<deepl-input-controller><template shadowrootmode="open"><link rel="stylesheet" href="chrome-extension://cofdbpoegempjloogbagkncekinflcnj/build/content.css"><div dir="ltr" style="visibility: initial !important;"><div class="dl-input-translation-container svelte-95aucy"><div></div></div></div></template></deepl-input-controller></body><div class="xl-chrome-ext-footer" id="xl-chrome-ext-footer">
                <div class="xl-chrome-ext-footer__ball animate__bounceOutUp">
                  <div class="xl-chrome-ext-footer__logo"></div>
                  <div class="xl-chrome-ext-footer__quantity">1</div>
                </div>
                <div class="xl-chrome-ext-footer__bar xl-chrome-ext-footer__bar--hidden">
                  <div class="xl-chrome-ext-footer__content">
                    <p class="xl-chrome-ext-footer__text">检测到页面存在1个资源</p>
                    <div class="xl-chrome-ext-footer__action">
                      <div class="xl-chrome-ext-footer__url download">
                        <div class="xl-chrome-ext-footer__action-name">下载</div>
                      </div>
                      <div class="xl-chrome-ext-footer__url cloudAdd" style="display: none;">
                        <div class="xl-chrome-ext-footer__action-name">
                          <div class="xl-chrome-ext-footer__button-icon save"></div>
                          <span class="xl-chrome-ext-footer__button-text">
                            存云盘
                          </span>
                        </div>
                      </div>
                    </div>
                    <div class="xl-chrome-ext-footer__agreement" style="display: flex;">
                      <span>启用插件访问在线视频时，插件将在播放窗口展示对播放链接的快捷功能</span>
                      <span class="xl-chrome-ext-footer__know">我知道了</span>
                    </div>
                    <div class="xl-chrome-ext-footer__close-wrapper">
                      <div class="xl-chrome-ext-tips">
                        <div class="xl-chrome-ext-footer__close"></div>
                        <div class="xl-chrome-ext-title xl-chrome-ext-title--footer">本次关闭</div>
                      </div>
                    </div>
                  </div>
                </div>
                </div></html>